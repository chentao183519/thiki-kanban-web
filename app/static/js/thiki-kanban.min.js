"use strict";var kanbanApp=angular.module("kanbanApp",["ngRoute","entriesControllers","entriesServices","ui.sortable","tasksServices"]);kanbanApp.config(["$routeProvider",function(e){e.when("/entries",{templateUrl:"partials/entries.html",controller:"EntriesCtrl"}).when("/tasks",{templateUrl:"partials/tasks.html",controller:"TasksCtrl"}).otherwise({templateUrl:"partials/entries.html",controller:"EntriesCtrl"})}]);var entriesControllers=angular.module("entriesControllers",[]);entriesControllers.controller("EntriesCtrl",["$scope","$q","Entries","Tasks",function(e,t,r,n){var s=[],o=r.load(),a=[];o.then(function(r){e.entries=r,angular.forEach(e.entries,function(e){var t=n.loadTasksByEntryId(e.id);a.push(t)}),t.all(a).then(function(t){for(var r in t)s=s.concat(t[r]);console.log(s),e.tasks=s,e.sortableOptions={connectWith:".tasks",opacity:.5,start:function(e,t){},update:function(e,t){console.log("==========="+$(t.item.sortable.droptarget[0]).attr("entry"))},stop:function(e,t){console.log(t.item.scope());var r=JSON.parse($(t.item.sortable.droptarget[0]).attr("entry")).id;t.item.sortable.model.entryId=r,console.log(t.item.sortable.model)}}})}),e.createEntry=function(){var t=e.title,r={id:3333,title:t,status:0};e.entries.push(r)},e.showCreateTaskForm=function(e){$("#task-create-button-"+e).hide(),$("#task-create-form-"+e).show()},e.cancelCreateTask=function(e){$("#task-create-form-"+e).hide(),$("#task-create-button-"+e).show()},e.showCreateEntryForm=function(){$("#create-new-entry-button").hide(),$("#create-new-entry-form").show()}}]);var entriesServices=angular.module("entriesServices",["ngResource"]);entriesServices.factory("Entries",["$http","$q",function(e,t){return{load:function(){var r=t.defer();return e({method:"GET",url:"mock/entries/entries.json"}).success(function(e,t,n,s){r.resolve(e)}).error(function(e,t,n,s){r.reject(e)}),r.promise}}}]),kanbanApp.directive("repeatFinish",["$timeout",function(e){return{restrict:"A",link:function(t,r,n){1==t.$last&&e(function(){$(".entryTitle").editable(),t.$emit("ngRepeatFinished")})}}}]);var tasksServices=angular.module("tasksServices",["ngResource"]);tasksServices.factory("Tasks",["$http","$q",function(e,t){return{loadTasksByEntryId:function(r){var n=t.defer(),s=[];return e({method:"GET",url:"mock/tasks/tasks-"+r+".json"}).success(function(e,t,r,o){s=e,n.resolve(e)}).error(function(e,t,r,s){n.reject(e)}),n.promise}}}]);